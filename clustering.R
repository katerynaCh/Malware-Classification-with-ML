#Read the data from .bin file to a matrix Mat

infile <- "C:\\Users\\Kateryna\\data.bin"
con <- file(infile, "rb")
dim <- readBin(con, "integer", 2)
Mat <- matrix( readBin(con, "numeric", prod(dim)), dim[1], dim[2])
close(con)

#print (Mat)
Mat<-Mat[-1,]
Mat<-Mat[-59,]
Mat<-Mat[-38,]
Mat<-Mat[-2,]
Mat<-Mat[-56,]
Mat<-Mat[-51,]
Mat<-Mat[-37,]
Mat<-Mat[-145,]
Mat<-Mat[-46,]
Mat<-Mat[-36,]
Mat<-Mat[-57,]
Mat<-Mat[-49,]
Mat<-Mat[-41,]
Mat<-Mat[-45,]
#scale the matrix with mean 0

scaled.Mat<-scale(Mat)
#print (scaled.Mat)

#name the rows with the ids and plot the samples
rownames(scaled.Mat)<-(1:nrow(scaled.Mat))
plot (scaled.Mat)
text(scaled.Mat, labels=rownames(scaled.Mat), adj=1)

#remove all Na and NaN containing columns that appeared during processing. 
#Since our feature set is very big we can ignore those
scaled.Mat<-scaled.Mat[ , colSums(is.na(scaled.Mat)) == 0]
#scaled.Mat<-scaled.Mat[ , colSums(is.nan(scaled.Mat)) == 0]
#dim(scaled.Mat)
#print (scaled.Mat)

#perform kmeans clustering
k.done<-kmeans(scaled.Mat, centers=3)
k.done$size